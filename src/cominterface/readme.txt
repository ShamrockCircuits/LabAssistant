Move the communication portion of device.py into here